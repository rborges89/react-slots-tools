{"version":3,"sources":["../src/types.ts","../src/useSlots.tsx"],"names":["list"],"mappings":";;;;;AACO,IAAM,sBAAA,GAAyB,aAAA;;;ACStC,SAAS,YAAY,OAAA,EAAqD;AACxE,EAAA,IAAU,KAAA,CAAA,cAAA,CAAe,OAAO,CAAA,EAAG;AACjC,IAAA,MAAM,KAAA,GAAS,OAAA,CAAQ,KAAA,IAAS,EAAC;AAGjC,IAAA,OAAQ,KAAA,CAAM,IAAA,IACZ,KAAA,CAAM,QAAA,IACL,MAAc,sBAAsB,CAAA;AAAA,EACzC;AAEA,EAAA,OAAO,IAAA;AACT;AAOO,SAAS,SACd,QAAA,EACA,OAAA,GAAuB,EAAE,cAAA,EAAgB,OAAM,EAC5B;AACnB,EAAA,IAAI,CAAC,QAAA,EAAU;AACb,IAAA,MAAM,IAAI,MAAM,0DAA0D,CAAA;AAAA,EAC5E;AAEA,EAAA,MAAM,KAAA,GAAc,cAA0B,MAAM;AAClD,IAAA,MAAM,GAAA,GAAwB,EAAE,OAAA,EAAS,EAAC,EAAE;AAE5C,IAAA,MAAM,eAAsC,KAAA,CAAA,QAAA,CAAS,OAAA;AAAA,MACnD;AAAA,KACF;AAEA,IAAA,KAAA,MAAW,aAAa,YAAA,EAAc;AACpC,MAAA,IAAU,KAAA,CAAA,cAAA,CAAe,SAAS,CAAA,EAAG;AAEnC,QAAA,MAAM,IAAA,GAAO,YAAY,SAAS,CAAA;AAElC,QAAA,MAAM,UAAY,IAAA,IAAQ,MAAA,CAAO,IAAI,CAAA,CAAE,MAAK,IAAM,SAAA;AAIlD,QAAA,IAAI,CAAC,GAAA,CAAI,OAAO,CAAA,EAAG;AACjB,UAAC,GAAA,CAAI,OAAY,CAAA,GAA0B;AAAA,YACzC;AAAA,WACF;AAAA,QACF,CAAA,MAAO;AACL,UAAC,GAAA,CAAI,OAAY,CAAA,CAAwB,IAAA,CAAK,SAAS,CAAA;AAAA,QACzD;AAAA,MACF,CAAA,MAAO;AACL,QAAA,IAAI,CAAC,IAAI,OAAA,EAAS;AAChB,UAAA,GAAA,CAAI,UAAU,EAAC;AAAA,QACjB;AAEA,QAAA,GAAA,CAAI,OAAA,CAAQ,KAAK,SAAS,CAAA;AAAA,MAC5B;AAAA,IACF;AAMA,IAAA,OAAO,GAAA;AAAA,EACT,CAAA,EAAG,CAAC,QAAQ,CAAC,CAAA;AAEb,EAAA,MAAM,GAAA,GAAY,KAAA,CAAA,WAAA;AAAA,IAChB,CAAC,MAAqB,QAAA,KAA+B;AACnD,MAAA,MAAMA,KAAAA,GAAO,MAAM,IAAS,CAAA;AAE5B,MAAA,IAAIA,KAAAA,IAAQA,MAAK,MAAA,EAAQ;AACvB,QAAA,OAAOA,KAAAA;AAAA,MACT;AAEA,MAAA,OAAO,QAAA,IAAY,IAAA;AAAA,IACrB,CAAA;AAAA,IACA,CAAC,KAAK;AAAA,GACR;AAEA,EAAA,MAAM,GAAA,GAAY,KAAA,CAAA,WAAA;AAAA,IAChB,CAAC,IAAA,KAAwB;AACvB,MAAA,MAAMA,KAAAA,GAAO,MAAM,IAAS,CAAA;AAC5B,MAAA,OAAO,CAAC,EAAEA,KAAAA,IAAQA,KAAAA,CAAK,MAAA,CAAA;AAAA,IACzB,CAAA;AAAA,IACA,CAAC,KAAK;AAAA,GACR;AAEA,EAAA,MAAM,IAAA,GAAa,KAAA,CAAA,WAAA;AAAA,IACjB,CAAC,IAAA,KAAwB;AACvB,MAAA,OAAQ,KAAA,CAAM,IAAS,CAAA,IAAK,EAAC;AAAA,IAC/B,CAAA;AAAA,IACA,CAAC,KAAK;AAAA,GACR;AAEA,EAAA,OAAO,EAAE,KAAA,EAAO,GAAA,EAAK,GAAA,EAAK,IAAA,EAAK;AACjC","file":"index.mjs","sourcesContent":["export type ATTR_SLOT_NAME = \"parent-slot\"\nexport const ATTR_SLOT_NAME_LITERAL = \"parent-slot\" as const\n\nexport type SlotNameProp = {\n    /** Perfer: <Child slot=\"header\" /> (similar to Web Components) */\n    slot?: string;\n    /** Other alternatives */\n    slotName?: string;\n    [ATTR_SLOT_NAME_LITERAL]?: ATTR_SLOT_NAME;\n};\n\n/** slots maps: last of nodes names based on hook generic T .*/\nexport type NamedSlotsMap<T extends string> = Partial<\n    Record<T | \"default\", React.ReactNode[]>\n> & { default: React.ReactNode[] };\n\nexport type UseSlotsResult<T> = {\n    /** Object with named slots. */\n    slots: NamedSlotsMap<T extends string ? T : never> & {\n        default?: React.ReactNode[];\n    };\n    /** Return requested children slot by name or fallback. */\n    get: (name: T | \"default\", fallback?: React.ReactNode) => React.ReactNode;\n    /** Return if slot exist. */\n    has: (name: T | \"default\") => boolean;\n    /** Return list of slots. */\n    list: (name: T | \"default\") => React.ReactNode[];\n};\n\nexport type hookOptions = {\n    forcedAllSlots: boolean\n}","import * as React from \"react\";\nimport {\n  ATTR_SLOT_NAME,\n  ATTR_SLOT_NAME_LITERAL,\n  SlotNameProp,\n  NamedSlotsMap,\n  UseSlotsResult,\n  hookOptions,\n} from \"./types\";\n\nfunction getNodeName(element: React.ReactNode): string | null | undefined {\n  if (React.isValidElement(element)) {\n    const props = (element.props ?? {}) as SlotNameProp &\n      Record<string, unknown>;\n\n    return (props.slot ??\n      props.slotName ??\n      (props as any)[ATTR_SLOT_NAME_LITERAL]) as string | null;\n  }\n\n  return null;\n}\n\n/**\n * Hook for extract \"slots\" from children special prop.\n * Recognizes props: slot, slotName and \"slot-name\".\n * All child without name belongs 'default' slot.\n */\nexport function useSlots<T extends string>(\n  children: React.ReactNode,\n  options: hookOptions = { forcedAllSlots: false }\n): UseSlotsResult<T> {\n  if (!children) {\n    throw new Error(\"react-slot-tools: required children parameter is missing\");\n  }\n\n  const slots = React.useMemo<NamedSlotsMap<T>>(() => {\n    const out: NamedSlotsMap<T> = { default: [] } as NamedSlotsMap<T>;\n\n    const slotsAsArray: React.ReactNode = React.Children.toArray(\n      children\n    ) as Array<React.ReactNode>;\n\n    for (const slotChild of slotsAsArray) {\n      if (React.isValidElement(slotChild)) {\n        /* search slot name */\n        const name = getNodeName(slotChild);\n\n        const slotKey = ((name && String(name).trim()) || \"default\") as\n          | T\n          | \"default\";\n\n        if (!out[slotKey]) {\n          (out[slotKey as T] as React.ReactNode[]) = [\n            slotChild as React.ReactNode,\n          ];\n        } else {\n          (out[slotKey as T] as React.ReactNode[]).push(slotChild);\n        }\n      } else {\n        if (!out.default) {\n          out.default = [];\n        }\n\n        out.default.push(slotChild);\n      }\n    }\n\n    /* if (options.forcedAllSlots) {\n      const keysExceptDefault = Object.keys(out).filter((k) => k !== \"default\");\n    } */\n\n    return out;\n  }, [children]);\n\n  const get = React.useCallback(\n    (name: T | \"default\", fallback?: React.ReactNode) => {\n      const list = slots[name as T];\n\n      if (list && list.length) {\n        return list;\n      }\n\n      return fallback ?? null;\n    },\n    [slots]\n  );\n\n  const has = React.useCallback(\n    (name: T | \"default\") => {\n      const list = slots[name as T];\n      return !!(list && list.length);\n    },\n    [slots]\n  );\n\n  const list = React.useCallback(\n    (name: T | \"default\") => {\n      return (slots[name as T] ?? []) as React.ReactNode[];\n    },\n    [slots]\n  );\n\n  return { slots, get, has, list };\n}\n"]}